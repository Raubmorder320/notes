# Основные определения
Везде, где не оговорено обратное, речь идёт про конечные графы. Существуют также бесконечные, не все определения для них сохраняются
## Граф, подграф
**Граф**
Граф: $G := (V(G),E(G))$
- $V(G)$ - мн-во вершин
- $E(G)$ - мн-во рёбер
Графы бывают:

| ---                              | Ориентированный                                                                                                                                                              | Неориентированный                                                                                                                                                                                                                                                                          |
| -------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Без кратных рёбер и петель**   | $G=(V,E)$<br>$E \subset V\times V$ произвольное отношение. Вырожденные рёбра исключены (хотя это вопрос соглашения)<br>$(a,b)$ ребро <=> a -- начало ребра, b -- конец ребра | $G=(V,E)\;\;$<br>$E\subset ^{(V\times V)\backslash\Delta} /_{(a,b)\sim(b,a)}$, то есть нет различия между $(a,b)$ и $(b,a)$<br>Отношение $E$ **симметрично**, но **симметричные пары не отличимы**<br>$(a,a)$ нет (хотя иногда удобно, чтобы были. Они именуются **вырожденными рёбрами**) |
| **С кратными рёбрами и петлями** | $G=(V,E)$<br>$(s,t): E\rightarrow V\times V$<br>Это означает, что в одну и ту же пару $(s,t)$ может прийти несколько рёбер $e$<br>Пара $(a,a)$ означает **петлю**            | $G=(V,E)\;\;$<br>$(s,t):E\rightarrow ^{(V\times V)} /_{(a,b)\sim(b,a)}$, то есть нет различия между $(a,b)$ и $(b,a)$<br>Отношение $E$ **симметрично**, но **симметричные пары не отличимы**. Аналогично, $(a,a)$ - петля.                                                                 |
Отображения, аналогичные тем, что даны для графов с кратными рёбрами, можно дать и для графов без кратных рёбер. В данном случае это будет означать, что отображение **инъективно** (каждой паре вершин соответствует ровно одно ребро, тогда как для графа с кратными рёбрами одной паре может соответствовать несколько рёбер)

**Подграф**
$G'=(V',E',(s',t'))$ является подграфом графа $G=(V,E,(s,t))$, если:
1. $V'\subset V$
2. $E' \subset E$
3. $(s',t'):= (s,t)|_{E'}$ и $(s',t')(E')\subset V'\times V'$
Или так, чтобы данная диаграмма была коммутативной:
$$
\begin{CD}
E @>{(s,t)}>> V\times V\\
@AAA @AAA \\
E' @>{(s',t')}>> V'\times V'
\end{CD}$$
Аналогичным образом сохраняется отличие орграфа от неорграфа.

Примеры **операций над графами**, создающих подграфы:
- **Исключение рёбер**
- **Исключение вершин** (влечёт исключение рёбер с ней, иначе нарушается коммутативность диаграммы)
 - **Стягивания рёбер**
$$
\begin{CD}
A @.X @. @. A@.@.X\\
@VVV @VVV @. @VVV @. @VVV\\
C_1 @>>> C_2@.{\Longrightarrow} @. \rightarrow @. C  @. \leftarrow\\
@AAA @AAA @. @AAA @. @AAA\\
B @.Y @.@.B @.@.Y
\end{CD}$$
При такой операции ($G=(V,E,(s,t)),\;\;G'=(V',E',(s',t'))$):
1. $V\rightarrow V'$
2. Удалённое ребро мы отображаем в вырожденное ребро (С,С).
Потому и удобно считать, что вырожденные рёбра есть. Также можно задавать граф, используя множество обычных рёбер, дизъюнктно объединённое с множеством вырожденных рёбер, то есть рёбер вида $(v,v)$. Или, что то же самое, дизъюнктно объединить с множеством вершин ($E\sqcup V$).
## Определения для вершин и подграфов
_____
**Инцидентность**
Пара вершина-ребро $(v,e)$ называется **инцидентной**, если вершина $v$ -- начало или конец ребра $e$. 

**Степень вершины**
Степенью (или порядком) вершины называется **количество рёбер, инцидентных с вершиной**.
- Минимальная степень вершины на графе: $\delta(G)$
- Максимальная степень вершины на графе: $\Delta(G)$
При подсчёте степени ребро-петля учитывается дважды.

**Смежность**
- **Вершины** называются **смежными**, если они соединены некоторым ребром
- **Рёбра** называются **смежными**, если они имеют общий конец
Вершина $u\in V(G)$ и множество $W \subset V(G)$ смежны, если $u \notin W$ и множество $W$ содержит вершину, смежную с $u$. Два непересекающихся множества $U,W\in V(G)$ называются смежными, если существуют смежные вершины $u\in U, w\in W$.

**Окрестность**
- $N_G(u)$ -- окрестность вершины $u$, то есть все вершины, смежные с ней.
- Для $U\subset V(G)$ окрестностью $N_G(U)$ называется множество всех вершин графа, смежных с $U$. (Внутрь такой окрестности не входят вершины из самого $U$!)

**Подграф**
- Остовный подграф G -- это такой подграф, в котором множество вершин совпадает с множеством вершин G
- Индуцированный подграф G -- это подграф, порождённый некоторым подмножеством $V(G)$, в котором остались рёбра, имеющие два конца на этом подмножестве

**Висячая вершина**
Это вершина со степенью 1

**Дополнительный граф**
Рассмотрим граф $E$ с тем же набором вершин, где все вершины соединены между собой (у каждой вершины степень $e(G)-1$). Тогда **дополнительным** к графу $G$ на этих вершинах будет называться граф $G'$ на тех же вершинах, рёбра которого есть в $E$, но нет в $G'$.
_____
## Путь на графе
**Путь на графе**
Пусть $v,w\in V(G)$
Тогда путь на графе - это последовательность невырожденных рёбер $e_1,e_2,...,e_n$, где:
1. $v_1 = v,\;\;v_n = w$
2. Последовательность:

| Для орграфа                                       | Для неорграфа                                                                                                                                  |
| ------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------- |
| $e_k = (v_k,v_{k+1})$ (или $s(e_{k+1}) = t(e_k)$) | Последовательность вершин $v_1\rightarrow v_2\rightarrow ... \rightarrow v_n$<br>Соответствующая ей последовательность рёбер $e_1,...,e_{n-1}$ |
**Путь длины ноль** ведёт из вершины в неё саму
**Цепь** - путь, в котором рёбра не повторяются
**Простая цепь**, она же **простой путь** - путь, в котором не повторяются рёбра и вершины

**"Определение"**
**Цикл** - простая замкнутая цепь (то есть $w=v$). Разница в том, что в цепи есть выделенная вершина (цепь же идёт а -> b -> c -> a, выделенная вершина а как начало и конец цикла), а в цикле нет выделенных вершин, они там равноправны. Можно считать это отношением эквивалентности (цепь a -> b -> c -> a эквивалентна цепи b -> c -> a -> b и тд)

**Теорема (без доква)**
Если между вершинами есть путь, то они соединены простой цепью
**Пояснение**
На самом деле это достаточно простой факт. Он основан на том, что любой цикл можно просто удалить

**Отношение достижимости**
Путь на графе определяет отношение достижимости: это означает, что существует путь между двумя вершинами
- **w достижима из v, если есть путь из v в w**
Это отношение рефлексивно и транзитивно, а если ещё и граф является неориентированным, то тогда это отношение эквивалентности (т.е. + симметричность). Классы эквивалентности в этом случае называются **компонентами связности**. При этом каждая компонента такого класса эквивалентности достижимых точек -- это подграф (порождённый вершинами из одного класса эквивалентности) исходного графа
- $V_0 \subset V \Rightarrow \;\;G(V_0)\;подграф\;\;:=\;\;G(V_0, E'),\;E':=\{e \in E \;\;|\;\;концы\;e \in V_0\}$
Важно, что элементами компоненты связности являются попарно связанные вершины. И если в неорграфе A -> B -> C -> D все четыре вершины являются отдельными компонентами связности, то в неорграфе А -- В -- С -- D это не так.

Отношение достижимости на орграфе является **отношением предпорядка**:
Отношение нестрогого порядка ($\preceq$): рефлексивное, антисимметричное, транзитивное
Отношение предпорядка: рефлексивное, транзитивное
Пусть $S$ отношение достижимости на орграфе. $vSw$, если $w$ достижимо из $v$. $vS^Tw$, если в обратную сторону тоже достижимо. Тогда $S\cap S^T$ -- рефлексивное, транзитивное, симметричное отношение
То есть $S\cap S^T$ -- отношение эквивалентности. Классы эквивалентности -- компоненты **сильной связности**. При этом пересечение таких компонент для неорграфа даст исходный граф, но вот для орграфа это не факт.
## Матрицы, связанные с графами
**Матрица инцидентности для ографа** 
I(G), где G -- орграф. Матрица размера VxE (столбцы -- рёбра, строчки -- вершины) в которой (v,e) равна: 
- 1, если t(e)=v (то есть ребро входит в вершину)
- -1, если s(e)=v (то есть ребро выходит из вершины)
- 0 иначе
Для петли пишется 0. Петле таким образом отвечает нулевой столбец. Это не сильно удачно по причине того, что не указывается, в каком ребре есть петля.
Это определение подходит и для графом с кратными рёбрами.

На неорграфе можно ввести ориентацию, потому что каждое ребро это технически два орребра
Для неорграфа часто считают, что компоненты берутся по модулю 2 (то есть -1 становится 1, то есть знак перестаёт влиять)

**Матрица смежности**
А(G) квадратная матрица VxV.
- Для неорграфа: (v,w) равна числу рёбер, ведущих из v -> w. По диагонали -- нули. Эта матрица симметрична
- Для орграфа: (v,w) разность между числом рёбер v -> w и числом рёбер в обратную сторону. Эта матрица кососимметрична. Обозначение \[$A^+(G)$]
Ранее считали, что граф без петель. Однако если они есть, то тогда по диагонали тоже что-то пишется, причём считаем петлю дважды (для неорграфа, в орграфе по разности всё равно даст ноль). Важно, что матрица смежности для орграфа и для неорграфа разные и обозначаются по-разному.

**Теорема**
Для неорграфа без петель $A(G)^q$ имеет следующий комбинаторный смысл:
Её компонента $(v,w)$ равна числу путей длины $q$ ведущих из $v \rightarrow w$
Также замечание: симметричная матрица, возведённая в степень, останется симметричной, поэтому $A(G)^q$ является симметричной.
**Доказательство**
Индукция по q.
- q = 0. При возведении в нулевую степень $A(G)$ даст единичную матрицу, что является количеством искомых путей
- q-1 -> q. $A(G)^q_{v,w}=\sum_{u\in V}A(G)^{q-1}_{v,u}A(G)_{u,w}=[\text{Искомое число путей}]$. Пример:
$$
\displaylines{
\begin{CD}
\overset{A(G)^{q-1}}
{\begin{bmatrix}
- & - & -\\
- & - & -\\
X & X & X
\end{bmatrix}} @.
\overset{A(G)}
{\begin{bmatrix}
- & X & -\\
- & X & -\\
- & X & -
\end{bmatrix}}
\end{CD}
\\\\
A(G)^q_{u_3,u_2} = [\text{Кол-во путей длины q-1 от u3 до u1}]\times[\text{Кол-по путей от u1 до u2}]\\+[\text{Кол-во путей длины q-1 от u3 до u2}]\times[\text{Кол-по путей от u2 до u2}]\\+[\text{Кол-во путей длины q-1 от u3 до u3}]\times[\text{Кол-по путей от u3 до u2}]}
$$

**Матрица Кирхгофа**
Иное название - **Лапласиан графа**.
Рассмотрим теперь $I(G)\times I(G)^T$. Это матрица размером $V\times V$, причём симметричная, так как умножение любой матрицы на транспонированную даст симметричную матрицу. Результат произведения не будет зависеть от ориентации графа, поэтому можно взять в том числе любой неорграф и ввести на нём произвольную ориентацию. При выполнении произведения для $[I(G)\times I(G)^T]_{u,w}$ мы фактически скалярно умножаем две строчки: u и w. Таким образом для каждого ребра $e$ мы смотрим, вышел ли путь из одной из этих точек и вошёл ли он во вторую. Если да, произведение будет равно -1, если путь вышел из одной вершины и ушёл в другую, или вышел из другой и пришёл в какую-то из них, или путь не начинался и не заканчивался на u или w, то тогда произведение равно нулю. $[I(G)\times I(G)^T]_{u,w} = (-1)[\text{Кол-во рёбер, соединяющих u и w}]$. (то есть ведущих u->w или w->u). По диагонали у такой матрицы стоят степени вершин: этим она отличается от -A(G).
## Лемма о рукопожатиях
**Лемма о рукопожатиях (для неорграфа)**
$$\sum_{v\in V} deg(v) = 2\text{card}(E)$$
**Доказательство**
Рассмотрим множество $V(G)\times E(G) \supset X := \{(v,e)\;|\;\text{e инцидентно v}\}$. Посчитаем количество элементов в данном множестве: 
$$\displaylines{card(X)=\sum_{v\in V} X\cap (\{v\},E)=\sum_{v\in V}deg(v)=\\=\sum_{e\in E}X\cap (V,\{e\})=2card(E)}$$
Короче говоря, утверждение следует напрямую из того, что у каждого ребра ровно два конца.

___
**Следствие**
Количество вершин нечётной степени в любом графе чётно
**Пояснения**
Иначе бы получилось, что $\sum deg(u)$ было бы нечётным, а оно всегда чётно по доказанной выше лемме
___
## Деревья
Рассмотрим неориентированный граф $G=(V,E)$, а также: $v(G):=card(V)$, $e(G):=card(E)$, $c(G) := \text{Количество компонент связности}$.

**Определения дерева и леса**
- Связный граф без циклов называется **деревом**.
- Граф без циклов (связный или несвязный) называется **лесом**. Лес может содержать множество несвязанных деревьев. Их количество равно $c(G)$ данного леса.
- **Мост** в графе -- ребро, удаление которого увеличивает число компонент связности в графе.
- **Остовный лес** -- подграф с тем же множеством вершин, а отношение эквивалентности по достижимости даёт такие же компоненты связности (где множество рёбер -- подмножество исходного множества рёбер).
- **Диаметр дерева** -- максимальная длина кратчайшего пути между двумя вершинами в дереве

**Ряд сведений о деревьях**
- Любое ребро в лесу или в дереве является мостом (допустим, не так; тогда удалим ребро, которое не мост, а его концы будут находиться в одной компоненте связности; однако это означает наличие цикла, который замыкался удалённым ребром; аналогично доказательство с удалением вершин в циклах). Обратное утверждение также верно (Граф, в котором каждое ребро является мостом, является лесом)
- При стягивании вершин в лесу получается лес (допустим, не так; значит, у нас после стягивания появился цикл, но это значит, что цикл был изначально)
- Любой граф можно довести до остовного леса, выбросив все рёбра, которые не являются мостами

**Предложение**
1. $v(G)-e(G)\le c(G)$
2. $\text{равенство выполнено} \Leftrightarrow \text{G - лес}$
**Доказательство**
1. Индукция по числу рёбер. С 0 рёбрами всё работает. Теперь рассмотрим удаление ребра из случайного графа. В этом случае количество рёбер уменьшится на одно, а количество компонент связности или не увеличится, или увеличится на единицу (если удалён мост). То есть есть два варианта:
   1) $v(G)-[e(G)-1]\le[c(G)+1] \Rightarrow v(G)-e(G) \le c(G)$
   2) $v(G) - [e(G)-1] \le c(G) \Rightarrow v(G)-e(G)\le v(G)-e(G)+1\le c(G)$
2. 
   1) Такая же индукция по числу рёбер. Для леса с нуля рёбрами равенство работает. Выбрасываем из дерева в лесу ребро. Получаем на одну компоненту связности больше и на одно ребро меньше. Получим $v(G)-[e(G)-1]=[c(G)+1] \Rightarrow v(G)-e(G) = c(G)$. Здесь же мы доказали, что для любого леса выполняется именно равенство
   2) Допустим, равенство выполнено не для леса. Тогда начинаем выбрасывать не-мосты. Количество компонент связности не увеличится, а вот количество рёбер уменьшится. По итогу мы получим (по предположению, что любой граф приводится к остовному лесу) лес, в котором: $v(G)-e(G)< v(G)-e(G)+n=c(G)$. Однако мы уже доказали, что в любом дереве должно выполнятся равенство. Значит, изначально был не лес, то есть равенство выполнено тогда и только тогда, когда граф -- лес.

---
**Теорема**
В дереве с $n$ вершинами ровно $n-1$ ребро.
**Доказательство**
1. n=1. Работает
2. Добавляем вершину к дереву. По итогу увеличим и количество вершин, и количество рёбер на 1. То есть искомое соотношение сохранится
---
## Ранг графа
**Ранг графа**
Число $v(G)-c(G)$ называется рангом графа. Называется оно так по причине того, что это ранг матрицы инцидентности. 
**Пояснение**
Матрица инцидентности строится относительно некоторой ориентации. В случае неографа ориентация может быть задана произвольно
**Теорема**
$$v(G)-c(G)=rank(I(G))$$
**Доказательство**
1. Заметим, что выкидывание не-моста не меняет ранг
Рассмотрим такую картинку:
$$
\begin{CD}
x_1 @>>> x_2 @.@. x_1 @>>> x_2\\
@AAA @VVV @.\Rightarrow @. @VVV\\
x_4 @<<< x_3 @.@. x_4 @<<< x_3
\end{CD}$$
Очевидно, что $e_1 = (x_4,x_1)$ не является мостом. Помним, что каждое ребро -- это столбец в $I(G)$. Получим, что: $e_2 = (x_1,x_2) \longrightarrow \begin{bmatrix}1\\-1\\0\\0\end{bmatrix} = I_{\circ,e_2}(G)$, $e_3 = (x_2,x_3) \longrightarrow \begin{bmatrix}0\\1\\-1\\0\end{bmatrix}  = I_{\circ,e_3}(G)$ , $e_4 = (x_3,x_4) \longrightarrow \begin{bmatrix}0\\0\\1\\-1\end{bmatrix} = I_{\circ,e_4}(G)$. В линейной комбинации они как раз и дадут $e_1 = (x_4,x_1) \longrightarrow \begin{bmatrix}-1\\0\\0\\1\end{bmatrix}  = I_{\circ,e_1}(G)$: $I_{\circ,e_1}(G) = \pm I_{\circ,e_2}(G) \pm I_{\circ,e_3}(G) \pm I_{\circ,e_4}(G)$. Этот случай уже записан в общем виде. Получается, что не-мост является линейно-зависимым от столбцов других участников цикла, а значит его исключение не уменьшит количество ЛНЗ столбцов и, следовательно, не изменит ранг. Важно помнить, что ориентация может быть любая. То есть, например, ребро $e_2$ может выглядеть и как $(x_1,x_2)$, и как $(x_2,x_1)$. Поэтому мы выбираем один из знаков: выбираем некоторое направление цикла и, если направление ориентации ребра совпадает с выбранным направлением берём с минусом, иначе -- с плюсом.
2. Благодаря пункту 1 достаточно рассмотреть данную теорему только для леса (потому что выкидывание не-мостов, то есть приведение к остовному лесу, не меняет обе части уравнения)
Сгруппируем вершины и рёбра по их принадлежности к некоторой компоненте связности. Тогда матрица инцидентности будет иметь блочную структуру: те рёбра и вершины, что принадлежат одной компоненте, будут иметь на пересечении соответствующих строчек и столбцов значения $\{0,-1,1\}$, но те же строчки и столбцы в других местах будут иметь только значения ноль:
$$
\begin{CD}
I(G)=
\displaylines{
k_1\\-\\k_2\\-\\k_3\\-}\;\;
\overset{\;\;\;\;\;\;l_1\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;l_2\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;l_3}{\begin{bmatrix}
X&X&X&0&0&0&0&0\\
X&X&X&0&0&0&0&0\\
0&0&0&Y&Y&Y&0&0\\
0&0&0&Y&Y&Y&0&0\\
0&0&0&0&0&0&Z&Z\\
0&0&0&0&0&0&Z&Z\\
\end{bmatrix}}
\end{CD},\;\;\;\;\;\;
\displaylines{[\text{$x_1$...$x_k$ первая компонента}], [\text{$x_{k+1}$...$x_{k_2}$ вторая компонента}],...\\
[\text{$e_1$...$e_l$ первая компонента}], [\text{$e_{l+1}$...$x_{k_2}$ вторая компонента}],...}$$

При этом каждый блок является $I(G_{c_1})$ -- матрицей инцидентности компонент связности. Ранг общей матрицы становится равен сумме рангов таких вот матриц (потому что два столбца из разных блоков могут быть ЛЗ только если полностью нулевые, но они и так не посчитаются в ранг матрицы-блока, соответственно ранг общей матрицы равен количеству ЛНЗ столбцов матрицы, а значит равен количеству ЛНЗ столбцов к каждом блоке). Иным образом это можно сказать, продемонстрировав, что сумма пространства колонок каждого блока является прямой суммой. 
3. \[вариант док-ва от препода]. Докажем, что у любого дерева есть вершина степени 1, а если в нём есть рёбра, то их по крайней мере две. Для этого достаточно рассмотреть максимальный простой путь на данной графе. Если степень вершины не 1, то путь можно удлинить. Иначе степень равна 1. В итоге можно будет рассмотреть матрицы (при выкидывании висячей вершины связность не нарушается, используем ММИ):
   $$
\begin{CD}
I(G)=
{\begin{bmatrix}
\pm1&0&...&0\\
0&0&...&0&\\
...&...&...&...&\\
\mp1&0&...&0&\\
...&...&...&...&\\
0&...&...&...&\\
\end{bmatrix}}
\end{CD}\underset{\text{Элем. Преобр.}}{\longrightarrow}
I(G)=
{\begin{bmatrix}
1&0&...&0\\
0&0&...&0&\\
...&...&...&...&\\
0&0&...&0&\\
...&...&...&...&\\
0&...&...&...&\\
\end{bmatrix}}=
I(G)=
{\begin{bmatrix}
1&0&...&0\\
0&\\
...\\
0&&I(G\backslash\{x_0\})\\
...\\
0&\\
\end{bmatrix}}$$Получим: $rank(I(G\backslash\{x_0\}))=e(G\backslash\{x_0\})=e(G)-1=rank(I(G))-1 \Rightarrow rank(I(G))=e(G)=v(G)-1$
___
(более простое док-во)
3. Благодаря предыдущему пункту достаточно проверить теорему для одного дерева. В дереве компонента связности одна, поэтому вид теоремы меняется на:
$$v(G')=rank(I(G'))+1$$
Если дерево состоит из одной вершины, то это правда: ранг такой матрицы равен нулю. Если дерево невырожденное, то тогда пользуемся теоремой о том, что в дереве с n вершинами n-1 ребро и вспоминаем, что все рёбра ЛНЗ (иначе были бы циклы или несвязные одиночные вершины). Получается, теорема верна
___

## Цикломатическое число
Известно, что для любого графа $v(G)-e(G)\le c(G)$. Отсюда следует, что число $0 \le e(G)+c(G)-v(G)$  нестрого положительно (и равно ($\Leftrightarrow$) нулю в случае леса). Это число называется **цикломатическим числом графа**. 

**Предложение**
$$\text{Цикломатичекое число равно 1}\Leftrightarrow\;\text{В графе есть ровно 1 цикл}$$
**Доказательство**
1. =\>
   - Получается, что раз ЦЧ не ноль, то мы имеем не лес, а значит имеем не-мостовые вершины. Получается, что если удалить такую не-мостовую вершину, мы получим лес и ЦЧ станет нулём. Другими словами, такой граф мы получаем добавлением к лесу одного не-моста.
   - Рассмотрим две вершины дерева (мы ведь пытаемся проложить между ними не-мост). Между ними существует ровно один простой путь, потому что иначе там был бы цикл (достаточно посмотреть на первую вершину, в которой они расходятся, и первую, в которой сходятся обратно -- это и будет цикл)
   - Итого: граф с ЦЧ=1 получается добавлением не-моста к дереву, а само добавление образует цикл, которых изначально в дереве не было
2. <=
   - Пусть в графе есть ровно один цикл. Это значит, что если удалить из него один не-мост, цикл разорвётся и получится дерево с ЦЧ = 0. Получается $e(G)+c(G)-v(G) = e(G')+1+c(G')-v(G') = 0 + 1 = 1$
   - Другим числом оно не может быть в том числе и потому, что: оно не ноль, потому что не лес, потому что есть цикл; оно не больше единицы потому, что если оно не один, тогда при выкидывании ребра получаем ЦЧ не меньше единицы, что означает наличие других циклов, а их должно было быть ровно 1
Важно, что цикломатическое число объясняет только количество независимых циклов. Например, в данном неорграфе:
$$
\begin{CD}
x_0 @= x_1 @= x_2 @=x_3\\
@| @| @| @| \\
x_4 @= x_5 @= x_6 @= x_7\\
@.@|@|@.\\
@.x_8@=x_9
\end{CD}$$
Цикломатическое число равно трём, хотя количество циклов гораздо больше
## Эйлеровы графы
---
**Эйлеров путь** -- это путь, проходящий по всем рёбрам графа ровно один раз
___

**Эйлеров цикл** -- это замкнутый путь, который проходит через каждое ребро графа по одному разу.
Граф, в котором существует Эйлеров цикл, называется **Эйлеровым графом**

___
**Полуэйлеров граф** -- граф, в котором существует эйлеров путь
____

**Лемма**
Если в графе степень каждой вершины чётна, то начиная с любого ребра можно начать цикл, который проходит через каждое ребро единожды (но может несколько раз пройти через вершину).
**Доказательство**
- Начнём обходить такой граф. Построим некоторый путь $x_1\rightarrow x_2\rightarrow ...\rightarrow x_k$. Выбросим из изначального графа данный путь. Тогда степень вершины $x_k$, если она не совпадает с $x_1$, будет нечётной (в каждую вершину мы вошли столько же раз, сколько вышли, кроме $x_k$; даже если она совпадает с $x_n$ где-то в середине пути, в конце мы пришли в неё и не вышли). То, что в новом графе без данного пути степень $x_k$ нечётна означает, что она как минимум один, а значит у пути есть продолжение. Процесс, по условию $x_1 \ne x_k$, остановится тогда, когда $x_1=x_k$. 
**Пояснение**
1. Это ещё не эйлеров цикл. Это цикл, в котором каждое ребро содержится единожды, но это совсем не означает, что содержатся все рёбра графа. Также мы можем считать, что этот цикл простой: ведь если есть не простой цикл, то можно убрать подцикл в нём и получить простой цикл, проходящий через данное ребро:
$$
\displaylines{
\begin{CD}
x_0 @>>> x_1 @= x_1 @>>>x_3\\
@. @VVV @AAA @.@.\\
@. x_5 @.x_6 @.@.@.\Longrightarrow@.@.x_0@>>>x_1@>>>x_3\\
@.@VVV@AAA@.\\
@.x_8@>>>x_9 \\
\end{CD}
\\
\text{Здесь мы зафиксировали ребро $x_0\rightarrow x_1$}}$$


**Теорема**
$$\text{Граф Эйлеров} \Leftrightarrow \text{Граф связан и все его вершины имеют чётную степень}$$
**Доказательство**
1. =\> Эта часть аналогична лемме о рукопожатиях. Её результат: $\sum_{x\in V(G)} (x,e)\in X\subset V\times G = 2e(G)$. (грубо говоря, мы в каждую вершину приходим столько же раз, сколько выходим из неё)
2. <=. Связность очевидна. Смотрим на чётность степеней вершин. 
   - Рассмотрим замкнутый путь, проходящий через каждое ребро единожды, максимальной длины. Допустим, мы удалим этот путь из графа (точнее, удалим рёбра данного пути). Мы получим не обязательно связный граф, но граф с чётными степенями рёбер (потому что мы вычли чётное количество рёбер для каждой вершины). 
   - Пусть мы выбросили не все рёбра. Тогда есть хотя бы одно ребро, смежное с вершиной, входившей в цикл (следует из связности, раз граф связный, а выброшены не все рёбра, то можно найти путь от случайного оставшегося ребра до цикла). При этом (по лемме) в оставшемся графе каждое ребро входит в простой цикл. Получается, что мы выбросили цикл не максимальной длины, ведь можно было не "пройти мимо" того смежного ребра, а пройти сначала весь замкнутый путь до вершины, в которую входит то смежное ребро, и пройти цикл, вернувшись в ту же вершину (как бы соединив эти циклы)
   - Получим противоречие. Получается, что все рёбра в этом максимальном цикле. А значит он эйлеров

**Следствие** (тривиальное)
Если граф несвязный, а все вершины имеют чётную степень, то это объединение непересекающихся эйлеровых циклов

____
**Теорема**
Рассматриваем связные графы
$$\text{Граф полуэйлеров} \Leftrightarrow\text{Граф имеет 0 или 2 вершины с нечётной степенью}$$
**Доказательство**
1. (=\>) Если полуэйлеров путь замкнут, то этой эйлеров граф, нечётных вершин нет. Если незамкнут, то можно дополнить его одним ребром до замкнутости. Убирая обратно это ребро получим ровно две вершины с нечётной степенью
2. (<=) Если 0, то это эйлеров цикл, а значит граф эйлеров => полуэйлеров. Если две, то соединив эти вершины получим эйлеров цикл. Убирая добавленное ребро мы размыкаем эйлеров цикл, то есть получаем эйлеров путь 
___

**Произвольно вычерчиваемый граф**
Эйлеров граф $G$ называется **произвольно вычерчиваемым из вершины v**, если любой путь с началом в этой вершине можно продолжить до эйлерового цикла.
**Пример**
$$
\begin{CD}
x_0 @= @.@.@=x_4\\
@|@|@.@|@|\\
@.@=x_3@=@.\\
@|@|@.@|@|\\
x_2@=@.@.@=x_5
\end{CD}$$
Произвольно вычерчиваемый из $x_3$: $x_3 \rightarrow x_4 \rightarrow x_5 \rightarrow x_3 \rightarrow x_0 \rightarrow x_2 \rightarrow x_3$
Не произвольно вычерчиваемый из $x_0$: $x_0 \rightarrow x_3 \rightarrow x_2 \rightarrow x_0$ нельзя продолжить до ЭЦ.

**Предложение**
$$\text{$G$ произвольно вычерчиваем из $v$}\Leftrightarrow\text{Любой простой цикл в $G$ проходит через $v$}\;\;\;\;\;[1]$$
**Доказательство**
1. (=>). Допустим, не любой простой цикл проходит через $v$.  Значит, есть какой-то цикл, который не проходит через $v$. Если выбросить этот цикл, то оставшийся граф будет эйлеровым (По лемме, так как каждая вершина четной степени). Обойдём его по этому эйлеровому циклу. Теперь вернём удалённый цикл, но обойти мы его уже никак не сможем. Значит, граф не вычерчиваемый (!!!)
2. (<=). Рассмотрим случайный путь $v\rightarrow w$. Вычеркнем его из графа. У нас может получится два случая: 
   - $v=w$. Тогда при вычёркивании данного пути-цикла мы получим эйлеров граф (все вершины останутся чётными).
   - $v\ne w$. Так как изначальный граф эйлеров, то существует обратный эйлеров путь $w\rightarrow v$
   В изначальном графе существовала лишь одна компонента связности, а после вычёркивания данного пути их количество не увеличится (иначе был бы цикл, не проходящий через $v$). Значит компонента связности одна, причём граф или эйлеров, или полуэйлеров => есть обратный путь, который в объединение с изначальным даст эйлеров обход
**Пояснение**
1. Граф $G$ - эйлеров
2. См. рисунок: ![[Pasted image 20240801151738.png]]
## Двудольные графы
Граф $G=(V,E)$ называется **двудольным**, если существует **разбиение** $V=V_1\sqcup V_2,\;\;V_1\cap V_2=\varnothing$, а каждое ребро имеет вид $e=({v_1}_{\in V_1},{v_2}_{\in V_2})$ (соединяет вершину из $V_1$ с вершиной из $V_2$).

Ещё один вариант определения: граф называется двудольным, если у него существует правильная раскраска в два цвета: вершины можно раскрасить в два цвета так, чтобы две вершины одного цвета не были смежными.
____
А если можно правильно раскрасить в k цветов, то есть покрасив в k цветов не получить рядом вершины одного цвета, то этот граф называется k-дольным
____

**Критерий двудольности графа**
$$\text{Граф двудольный}\Leftrightarrow\text{все циклы в графе имеют чётную длину}$$
**Доказательство**
1. (=\>) Очевидно (потому что тогда рядом будут находиться вершины одного цвета, например, $X_{x_1}\rightarrow Y_{x_2}\rightarrow X_{x_3} \rightarrow X_{x_1}$)
2. (<=) Выдумаем такую раскраску. Достаточно это сделать для одной КС, это легко распространяется на остальные. Оказывается, что любой пусть из $v$ в $w$ имеет одинаковую чётность длины (если это не так, то простой замкнутый путь \[туда + обратно] имеет нечётную длину, то есть вершина $v$ окажется одновременно окрашенной в разные цвета, а не простой можно свести к рассмотрению повторяющейся вершины, у которой сумма двух путей нечётна, а значит один из путей \[до той же вершины!] нечётен).
## Изоморфизм графов
Два графа $G$ и $G'$ называются **изоморфными**, если:$$\begin{aligned}
1.&\;\;\exists\;\varphi:V(G)\rightarrow V(G')\\
2.&\;\;\ (x,y)\in E(G) \;\Leftrightarrow (\varphi(x),\varphi(y))\in E(G')
\end{aligned}$$
Такие графы фактически являются разными способами задать один и тот же граф. Его комбинаторные свойства не меняются.

Важным признаком неизоморфности графов являются отличающиеся степени его вершин. Однако вполне могут существовать графы на вершинах с одинаковыми степенями, но не изоморфные друг другу

____
Ещё одним способом определять изоморфность графов: [теорема Уитни](https://ru.wikipedia.org/wiki/%D0%98%D0%B7%D0%BE%D0%BC%D0%BE%D1%80%D1%84%D0%B8%D0%B7%D0%BC_%D0%B3%D1%80%D0%B0%D1%84%D0%BE%D0%B2#%D0%A2%D0%B5%D0%BE%D1%80%D0%B5%D0%BC%D0%B0_%D0%A3%D0%B8%D1%82%D0%BD%D0%B8)
____

# Блоки, точки сочленения
## Блоки и точки сочленения
**Точка сочленения** 
$v\in V(G)$ называется **точкой сочленения** в графе $G$, если при её удалении увеличивается число компонент связности.
**Пояснение**
Вершина со степенью ноль не является ТС

**Предложение**
$$\text{$v$ точка сочленения} \Leftrightarrow \text{существуют $u_1,u_2$ из одной КС (не $v$), что любой путь $u_1\rightarrow u_2$ проходит через $v$}$$
**Доказательство**
Тривиально. (=\>) раз кол-во увеличилось, то есть такие точки, что связаны только через $v$
(<=) Если это не ТС, то кол-во КС не должно увеличиться. Однако после удаления больше не будет путей. То есть увеличится

**Замечание**
В дереве любая не висячая вершина есть точка сочленения
**Доказательство**
Очевидно

**Замечание**
Любая точка цикла не является ТС
**Доказательство**
Очевидно

**Блок**
**Блок** -- максимальный по включению (по количеству точек, рёбра остаются теми же, что в изначальном графе) **_связный_** подграф без точек сочленения.
**Пояснение**
$$
\begin{CD}
 @. @= @= @=\\
@. @| @.@. @| \\
x_1 @= x_2 @=@= x_4 @= x_5 @=x_6\\
@.@|@.@|@.\\
@.@=x_3@=
\end{CD}$$
В этом графе ТС являются $x_2, x_5$, а блоком может быть  подграф 
$$
\begin{CD}
@= @= @=\\
@| @.@. @| \\
x_2 @=@= x_4 @= x_5 \\
@|@.@|@.\\
@=x_3@=
\end{CD}$$

**Замечание**
В блоке с $\ge 3$ вершинами через любые две вершины проходит простой цикл
**~~Доказательство~~** (смотри пояснение)
- В данном блоке в принципе существует цикл\[1]. Пусть он проходит через вершину $v$. Докажем, что он тогда проходит и через любую другую вершину $w$. 
- Пусть имеется цикл $C$, содержащий $v$, а $w$ в него не входит. Раз имеется блок, то между $w$ и циклом есть путь. Рассмотрим точку $x$ внутри цикла, сопряжённую с этим путём, и точку $y$ из пути, сопряжённую с $x$. Временно удалим точку $x$. Она не являлась точкой сочленения, потому есть второй путь от $v$ до $y$. "Перерисуем" цикл: теперь он будет идти от $v$ по новому пути до $y$, из $y$ в $x$, из $x$ в $v$. ![[Pasted image 20240731004947.png]]
- Точек, подобных $y$, в указанном пути конечное число. Потому итеративно можно вычёркивать всё новые и новые точки до тех пор, пока не будет найден маршрут между $v$ и $w$.
- Имеем: в блоке есть циклы. Есть циклы между конкретной $v$ и любой другой $w$. Зафиксируем точку $w$: тогда существует цикл между $w$ и любой точкой $z$. Значит, через любые две вершины проходит простой цикл
**==Пояснение==**
1. Иначе имеем дерево. В дереве на $3$ и более вершины есть как минимум одна не висячая. Пусть все висячие: тогда $\sum \deg(v) = n = 2\text{card}(E) = 2n-2\;\;\Rightarrow\;\;n=2$ (по лемме о рукопожатиях)

**==Предложение==**
В блоке:
1. Через любые два ребра проходит цикл
2. Для любых двух данных вершин и одно данное ребро проходит простой путь
**Доказательство**
- Условие (1) следует из (2). Возьмём одно ребро, а второе ребро рассмотрим как две его инцидентные вершины. По утверждению (2) они соединяются простым путём. Замыкая путь вторым ребром получим цикл. Значит и рёбра соединяются циклом
- Докажем второе утверждение. Зафиксируем ребро, проведём через него цикл\[1]. Соединим вершины с этим циклом и найдём там простой путь ![[Pasted image 20240731005357.png]]
**Следствие**
- Для любых двух случайных вершин $u,w$ и третьей случайной вершины $v$ существует путь, проходящий из $u$ в $w$ через $v$. \[2]
- Для любых двух случайных вершин $u,w$ и третьей случайной вершины $v$ существует путь, проходящий из $u$ в $w$, не проходящий через $v$. \[3]
**Пояснение**
1. Это возможно, потому что через любые две вершины проходит цикл, в том числе и те, которые смежны. В итоге либо ребро лежит в цикле, либо цикл можно сократить, выбросив одну из частей и поставив вместо неё ребро (левая часть рисунка)
2. Рассмотрим вместо $v$ некоторое инцидентное с ним ребро. По условию есть путь из $u$ в $w$ через ребро, а значит и через саму $v$. 
3. Есть путь из $u$ в $v$ через $w$. Просто отрезаем от него вторую часть пути

**Теорема**
1. Два блока имеют не более одной точки сочленения
2. Если при этом вершина принадлежит минимум двум блокам, то ($\Leftrightarrow$) она точка сочленения 
**Доказательства**
- Рассмотрим два блока с двумя общими вершинами. Объединим данные блоки. Получается, что удаление одной вершины не изменит связность графа\[1]. Из этого следует, что два блока с двумя общими точками это на самом деле один и тот же блок (потому что блок - максимальный подграф).
- (Второе утверждение, =\>) Раз так, то граф распался на несвязные. Потому что иначе у них было бы больше одной общей точки. А значит, она точка сочленения\[2]
- (<=) Рассмотрим изначальную компоненту связности, содержавшую данную точку. Тогда после её удаления компонента распалась минимум на две. Рассмотрим теперь некогда существовавший путь A->Y->B. Где Y смежна с А и с В, при этом А в первой КС, а В во второй КС. Точки А и В находятся в разных блоках, потому что иначе бы имелся путь между ними, который не затрагивает Y, а тогда количество КС не увеличилось бы
**Пояснение**
1. Вообще говоря, это очевидно. То, что было первым блоком, останется связным. И вторым тоже. А соединены они через вторую точку, которую мы не удаляли.
2. Ещё одна очевидная мысль. Рассмотрим "A->Y->B", где A лежит в первом блоке, B во втором, Y посередине и будет являться их общей точкой, причём смежной и с A, и с B. Если после удаления граф не потеряет связности, то есть ещё один путь между A->B. Тогда существует цикл, проходящий через A,Y,B и через другие точки обоих блоков. Тогда блок, состоящий их этого цикла, по наличию двух общих точек совпадает как с первым блоком, так и со вторым, что приравнивает все эти блоки друг с другом.
## Висячие блоки, дерево блоков
**Дерево блоков и точек сочленения**

Рассмотрим <u>граф</u>, в котором остаются лишь блоки, которые связаны со своими точками сочленения
![[Pasted image 20240917100605.png|240]]                                         ![[Pasted image 20240917100755.png|150]]



___Определение___ Пусть G связен. Обозначим $A_{1}...A_{n}$ — блоки, а $a_{1}...a_{m}$ — G. Построим двудольный граф TT, поместив $A_{1}...A_{n}$ и $a_{1}...a_{m}$ в различные его доли. Если точка сочленения принадлежит блоку, проведем между ними ребро. Полученный граф T называют **графом блоков-точек сочленения** графа G.

**Пояснение** _Почему дерево?_
1. Существует последовательность точек сочленения и блоков, соединяющая $A_{i}$ и $A_{j}$ и не содержащая $a_{k}$. По ней можно проложить путь в G (можем переходить из блока в блок по точке сочленения и из одной части блока в другую) и замкнуть его в вершине $a_{k}$, получив цикл. Получается, что некоторые рёбра из $A_{i}$ и $A_{j}$ принадлежат одному и тому же циклу, что противоречит тому, что они находятся в разных блоках.

**Висячий блок**
Блок называется висячим, если в нём содержится ровно одна точка сочленения исходного графа
**Пояснение**$$
\begin{CD}
x_0 @= @.@.@=x_4@=@.@.@=x_8\\
@|@|@.@|@.@|@.@|@|\\
@.@=x_3@=@.@.@=x_6@=@.@.\\
@|@|@.@|@.@|@.@|@|\\
x_2@=@.@.@=x_5@=@.@.@=x_7
\end{CD}$$Вот в таком графе висячими блоками будут левый и правый.

**Предложение**
В связном графе:
1. Или есть висячий блок
2. Или нет точек сочленения
**Доказательство**
- Построим дерево блоков и точек сочленения. При отсутствии точек сочленения нет и висячих блоков. В построенном дереве, если оно не вырождено, то есть если есть точки сочленения, обязательно существуют висячие вершины. <u>Проверим</u>, что это могут быть только блоки
- <u>Это</u> очевидно потому, что каждая ТС принадлежит минимум двум блокам. То есть имеет степень заведомо не меньше двух
## Перечисление деревьев. Код Прюфера
**Код Прюфера**
Перед доказательством следующей теоремы рассмотрим конструкцию Кода Прюфера. **Код Прюфера** сопоставляет произвольному конечному дереву с n вершинами последовательность из $n-2$ чисел (возможно, с повторениями). Данный алгоритм сопоставляет пронумерованное дерево с последовательностью из $n-2$ чисел **биективно**
- Для построения рассмотрим дерево. В каждый момент времени будем выбирать висячую вершину с наименьшим номером, а в последовательность будет вписывать номер связной с ней вершины. После эту висячую вершину удаляем ![[Pasted image 20240415020351.png]]
- Восстанавливаем исходное дерево. На первом месте стоит минимальная висячая вершина среди тех, чей номер не встречается в коде Прюфера. Рисуем её и присваиваем ей нужный номер, а также дорисовываем вершину, которая была с ней смежна. Выполняем это действие до конца кода. Осталось лишь дописать ещё одну висячую вершину к той, что была добавлена в конце ![[Pasted image 20240415022206.png]]

**Теорема (Кэли)**
Число деревьев с $n$ пронумерованными вершинами равно $n^{n-2}$
**Доказательство**
- По сути сводится к следующей формулировке со ссылкой на код Прюфера: доказать, что существует $n^{n-2}$ слов длины $n-2$ с алфавитом из $n$ букв. Это простая задача по комбинаторике
**Пояснение**
1. Здесь имеется в виду количество деревьев с нумерацией без учёта изоморфизма. Таким образом деревья $\begin{CD}1@=2@=3\end{CD}, \;\;\begin{CD}1@=3@=2\end{CD}, \;\;\;\begin{CD}2@=1@=3\end{CD}$ при игнорировании нумерации являются одним деревом, то есть изоморфны друг другу, но в рамках данной теоремы рассматриваются как разные

**Теорема Бине-Коши** (без доказательства)
Рассмотрим произведение двух прямоугольных матриц $A,B$: одной размером mxn, другой -- размером nxm. В результате получится матрица mxm. Определитель такой матрицы равен:$$\begin{cases}\;\;\;0&\text{if $n<m$}\\\;\;\;\sum \det[A^{i_1>i_2>..>i_m}_{1,2,...,m}]\det[B_{i_1>i_2>..>i_m}^{1,2,...,m}]&\text{otherwise} \end{cases}$$**Лемма**
$A\in M_n(\mathbb{R})$, $A=A^T$, $\text{rank} A = n-1$, $A\times\begin{bmatrix}1\\\vdots\\1\end{bmatrix}=\begin{bmatrix}0\\\vdots\\0\end{bmatrix}$. Тогда алгебраические дополнения всех элементов данной матрицы равны
**Доказательство**
- Рассмотрим взаимную матрицу. Про неё известно, что $A\times\overline{A}=(\det A)\times E$. В данном случае данное произведение равно нулю, ведь ранг не равен размерности, а значит имеются линейно зависимые столбцы/строки. Тогда любой столбец $\overline{A}$ - это решение ОСЛУ формата $A\overline{x}=\overline0$. Откуда и получаются единицы, умноженные на константу. В итоге матрица $\overline{A}$ имеет вид $\begin{bmatrix}1\\\vdots\\1\end{bmatrix}[c_1,c_2,\cdots,c_n]$. Учитывая, что исходная матрица симметрична, симметрична и взаимная матрица. Потому все данные $c_i$ попарно равны.
**Пояснение**
1. Матрица, составленная из алгебраических дополнений. см. Алгебра
2. Других решений нет потому, что размерность кёрнела данного отображения равна 1 по теореме о размерности ядра и образа

**Матричная теорема о деревьях**
Рассмотрим связный граф $G$. Тогда все алгебраические дополнения матрицы Кирхгофа равны числу остовных деревьев данного графа
**Доказательство**
- Для графа с одной вершиной доказывать нечего. Будем считать, что вершин хотя бы две
- Рассмотрим лапласиан графа: $L=I\times I^T$. Получим матрицу $I'$ путём вычёркивания последней строки. Легко убедиться, что определитель $\det (I'\times I^{'T})$ равен дополнению правого нижнего элемента лапласиана
- Учитывая, что $e(G)\ge v(G)-1$\[3], используем формулу Бине-Коши:$$L^{vv}=\sum\det[I^{i_1>i_2>..>i_{v-1}}_{1,2,...,v-1}]\det[I_{i_1>i_2>..>i_{v-1}}^{1,2,...,v-1}]=\sum(\det[I^{i_1>i_2>..>i_{v-1}}_{1,2,...,v-1}])^2\;\;\;\;\;[4]$$
- Легко убедиться, что каждый такой минор равен $\pm 1$, если матрица, составленная из $I'$ с добавлением к ней вычеркнутой ранее последней строки $I$ задаёт дерево, и 0 в обратном случае\[5].
**Пояснение**
1. Данное произведение просто даст тот же лапласиан, только без последней строки и последнего столбца
2. Этого нам более чем достаточно, потому что все алгебраические дополнения равны по лемме, следовательно, нам достаточно доказать равенство количеству остовных деревьев только для одного дополнения
3. Чтобы формула Бине-Коши не выдавала ноль автоматически нам это условие нужно
4. Если короче, получили сумму квадратов миноров $I'$ размера $(v-1)\times(v-1)$.
## Гамильтоновы пути (Билет 14)
**Гамильтонов путь**
Путь, проходящий через каждую вершину по одному разу называется **гамильтоновым**.
Аналогично даётся определение гамильтонова цикла
**Замечание**
- Аналогичное определение, но для пути, проходящего через каждому ребру по одному разу, давалось ранее - Эйлеров путь

**Предложение**
В полуполном орграфе существует гамильтонов путь
**Доказательство**
- Индукцией по длине пути. Пусть построен некоторый путь. Рассмотрим новую, не входившую в данный путь вершину. Из неё может существовать ребро, ведущее в начало пути, или ребро, ведущее в неё из конца пути. Тогда путь легко продлевается. 
- Если пути лежат в другом направлении (то есть из первой вершины в новую и из новой вершины в последнюю), то ищем такую вершину пути, что есть путь из неё в новую, но ребро от следующей за ней вершины до новой имеет другую ориентацию 
![[Pasted image 20240917171807.png|400]]
**Пояснение**
1. Полуполный ориентированный граф (полуполный орграф, semi-complete digraph) - это граф, в котором любые две вершины соединены **в точности одним** ребром, на котором задана некоторая ориентация.
2. Мы как бы "вставляем" новую вершину в середину пути
**Замечание**
Для того, чтобы в полуполном орграфе существовал гамильтонов цикл, достаточно, чтобы граф был сильно связан (Для любых вершин существует путь $v \rightarrow w$ и путь $w \rightarrow v$). Отметим, что из сильной связности графа следует, что в графе нет _стоков_ и _источников_:
$$
\begin{CD}
x@<<<y\\
@AAA@VVV\\
z@<<<w
\end{CD}
\begin{aligned}
1.&\;\;\text{х - сток (все пути ведут В него)}\\
2.&\;\;\text{y - источник (все путь идут ИЗ него)}\\
\end{aligned}$$
**Доказательство**
![[image_2024-06-17_17-55-23.png|600]]
- Если стоки и источники существуют, то очевидно, что цикла нет (потому что для цикла в вершину нужно прийти и покинуть хотя бы единожды)
- Пойдём сначала индукцией по количеству вершин. Легко перечислить все полуполные орграфы с 3-мя вершинами и сказать, что для них условие верно. Рассмотрим теперь случайный граф. Зафиксируем некоторую вершину и обозначим её $v_0$. Раз граф полуполный и ориентированный, а сама вершина не сток и не источник, то все вершины разбиваются на две категории - те, из которых есть путь до $v_0$ ($X$) и те, в которые есть путь из $v_0$ ($Y$). Причём очевидно, что существует хотя бы одна вершина, идущая из $Y$ в $X$, ведь иначе потерялась бы сильная связность. Таким образом существует цикл хотя бы длины три
- Выделим теперь вместо одной вершины $v_0$ некоторый цикл $V_0$. Снова разделим остальные вершины на $X$ и $Y$. Найдём дополнительные две вершины, которые легко встраиваются в уже построенный цикл. Идя так итеративно строим и весь гамильтонов цикл

**Теорема Оре** (Билет 15)(Достаточное условие существования гамильтонова цикла на неорграфе)
Если в графе есть несмежные вершины и для любых двух из них $\deg v + \deg u \ge v(G)$, то в графе существует гамильтонов цикл
**Доказательство**
- Возьмём граф, удовлетворяющий данному условию, но без гамильтонова цикла, и будем добавлять в него _рёбра_ до тех пор, пока это возможно сделать, не образовывая гамильтонова цикла \[процесс называется насыщение]
- Рассмотрим случайную пару не смежных вершин в этом насыщенном графе. Добавим между ними ребро и получим граф с гамильтоновым циклом. Понятно, что этот гамильтонов цикл проходил через это ребро. Тогда в изначальном насыщенном графе был гамильтонов путь
- По условию Оре получается, что вершины на краях пути связаны ещё одним способом\[1] (как на рисунке). Таким образом и получается гамильтонов цикл![[Pasted image 20240415100437.png]]
- Таким образом мы построили "насыщенный" граф без гамильтонова цикла, в котором, однако, оказался гамильтонов цикл. Это противоречие доказывает, что изначально графов без гамильтоновых циклов с выполненным условием Оре не существует.
**Пояснение**
1. Такая картина (когда одна вершина смежна с концом пути, а следующая - с началом пути) обязательно возникнет. Пусть вершина из конца пути связана с $n$ вершинами, при этом вершина из начала пути не связана с её последующими вершинами. То есть не связана с $n$ вершинами. Получается, $\deg u = n, \deg v \le v(G)-n-1$, откуда следует $\deg v + \deg u \le v(G)-1$. Такой же принцип используется в более общем виде для доказательства наличия цикла длины $n$ при наличии пути длины $n$ и аналогичным условием на количество смежных вершин.
2. Граф с гамильтоновым циклом - **гамильтонов граф**
**Следствие**
**Теорема Дирака** (Достаточное условие существования гамильтонова цикла на неорграфе)
Если для любой вершины $\deg v > \frac{v(G)}{2}$, то в графе существует гамильтонов цикл
**Доказательство**
- очевидно
## Поиск в глубину
В теории графов используется такой объект, как **корневые деревья**. Одна вершина дерева объявляется корнем, после чего все рёбра ориентируются в направлении “от корня”. Один из видовых таких деревьев - **DFS-деревья** или **деревья поиска в глубину**.
**Пояснение**
- Здесь и далее будем считать, что граф связен. Исходный граф именуется $G$. Если зачем-то понадобится именовать DFS-дерево, то оно будет обозначено $T$.

**Алгоритм построения DFS-Tree**
Нумеруем вершины
0. Начинаем с произвольной вершины (её номер - 1)
1. Для данной отмеченной вершины находим неотмеченного соседа. Присваиваем ему номер и устанавливаем его как основную вершину, повторяем пункт 1
2. Если у данной вершины неотмеченных соседей нет, возвращаемся назад
В процессе отмечаем лишь рёбра, по которым делался переход.
**Пример**
![[Pasted image 20240415122158.png]]

**Утверждение** (тривиальное)
При обходе в глубину будут включены все вершины исходного графа

**Прямые и обратные рёбра**
Запустим DFS из произвольной вершины. Введем новые виды рёбер:
- **Прямые** рёбра - те, по которым были переходы в DFS.
- **Обратные** рёбра - то, по которым не было переходов в DFS.

**Продольные и поперечные рёбра**
Обратные рёбра можно разделить на две категории. 
- **Продольные** - если одна из его вершин является предком другой в DFT-tree
- **Поперечные** - в ином случае

На показанном ниже рисунке потенциальным поперечным ребром могло бы быть ребро $(7,8)$ или $(12,4)$. Однако для DFS-деревьев имеет место следующее утверждение:![[Pasted image 20240806002350.png]]
**Утверждение**
В дереве поиска в глубину нет поперечных рёбер
**Доказательство**
- Рассмотрим некоторое ребро $(x,y)$. Допустим, что $y$ не является потомком $x$ в DFS-дереве. В таком случае оказывается, что после прохождения их общего предка $z$ в первый раз, спуска вниз и нахождения ребра $x$, мы поднялись до $z$ ещё раз и спустились до $y$, которая была не отмечена.
- Однако это входит в противоречие с алгоритмом DFS, ведь он изначально должен был пройти через все не отмеченные вершины - соседи вершины $y$. То есть после встречи с $x$ вершина $y$ должна была быть отмечена до подъёма наверх в $z$.
- Следовательно, ребре $(x,y)$ просто не существует

**Замечание** (Это уже следующий билет - 12)
Построение DFS-дерева задаёт функцию-нумерование вершин этого дерева. Обозначим её $n(v)$.
Одновременно с этим можно определить функцию $L: V\rightarrow \mathbb{N}$ определённую (рекурсивно, начиная от висячих вершин) следующим образом:
- Для висячей вершины $u$ это: $L(u)=\min\{n(y)\;|\;uy\in E(G)\}$\[2]
- Для не висячей $v$ это: $L(v)=\min\{\;(L(y):wy\in E(G)\;|\;w\text{ дочерняя вершина }v)\;\cup\;(n(y)\;|\;(v,y)\in E(G))\;\}$\[3]
Иначе говоря, функция $L(q)$ - это наименьший номер вершины, в которую существует ребро из его потомка или из него самого
**Пояснение**
1. Если каждый раз при "активации" вершины - то есть при первом переходе в вершину - мы будем присваивать ей порядковый номер такой активации
2. То есть минимальный номер смежной вершины в исходном графе
3. То есть наименьший $L(x)$ вершины, смежной с _дочерней_ данной, а также наименьший номер вершины, до которой можно дойти из самой $v$
4. Напоминание: дочерняя вершина - это _смежная_ вершина большей глубины
**Критерий точки сочленения**
Из сказанного выше прямо следует **критерий точки сочленения:**
$$\text{$v$ - ТС}\;\;\Leftrightarrow\;\;\text{$\exists\;w$ - потомок, что $L(w)=n(v)$}$$
**Висячий блок**
Если $x$ - висячая вершина DFS-дерева, то висячий блок будет определятся точкой $u$ предком $x$, что:
- У дочерней к $u$ дочки $w$, лежащей на пути $(u,x)$, $L(w)=n(u)$\[1]
- Номер $u$ - наибольший из возможных \[2] 
**Пояснение**
1. Данное условие даёт нам гарантию, что ни из какого ещё потомка $u$ в направлении к точке $x$ не будет выходить ребро выше точки $u$. Это же условие автоматически означает, что $u$ - точка сочленения
2. То есть данная вершина ближе всего к самой висячей вершине $x$, она лежит "глубже всего" в построенном дереве
3. Данное условие в целом означает, что на пути $u\longrightarrow x$ при проходе начиная с $x$ любые два соседних ребра находятся в одном цикле, в свою очередь ребро $(u,w)$ \[$w$ - потомок по направлению к $x$] и ребро $(u,p)$ - любое другое ребро инцидентное $u$ - не лежат в одном цикле  

**Предложение** (Билет 13)
$$\text{ребро $(v,w)$ DFS-дерева - мост}\;\;\Leftrightarrow\;\;\begin{cases}L(w)=n(v)\\\text{Для любой дочерней вершины $u$}:L(u)=n(w)\end{cases}$$
**Доказательство**
- (=\>) Очевидно
- (<=) Выбросим ребро $(v,w)$. Окажется, что то, что лежит ниже $w$ - отдельная компонента связности просто по построению
**Пояснение**
1. Всё это условие означает, что, во-первых, из $w$ ребро наверх идёт только в $v$, а во-вторых, что ни из какого потомка вершины $w$ ребро не уходит выше $w$.
**Следствие**
- Пусть дан связный неорграф без мостов. Тогда на нём можно ввести такую ориентацию, что получится сильно связный орграф. Для этого расставим стрелки:
  1) Вниз по прямым рёбрам
  2) Вверх по обратным рёбрам

## Поиск в ширину (Билет 16)
**Поиск**
![[Pasted image 20240420021726.png]]
**НА КАРТИНКЕ СЛОМАНА НУМЕРАЦИЯ, СМОТРИ НА СТРЕЛКИ!**
1. Создаётся очередь. В неё загружается вершина, с которой начинается поиск
2. Переходим в вершину из очереди. В очередь дописываем все дочерние вершины, которые ещё не были пройдены и которые ещё не лежат в очереди. Одновременно с этим все эти дочерние вершины пишем в граф
3. Если очередь пуста, то поиск закончен. Если нет, то перейти к пункту 2
Очевидно, что номер родительской вершины меньше, чем номер дочерней вершины
Ещё один важный факт: если имеются две вершины $x_1,x_2$ и к каждой из них своя дочерняя вершина $y_1,y_2$, то $n(y_1)>n(y_2)\;\Rightarrow\;n(x_1)\ge n(x_2)$.

**Теорема**
Введём функцию высоты. Корень дерева имеет высоту 0, каждая дочерняя вершина имеет высоту на 1 больше, чем родительская.
Тогда $h(v)$ - длина кратчайшего расстояния от корня до $v$ в исходном графе
**Доказательство**
- Если $x$ и $y$ смежные вершины, то $|h(x)-h(y)| \le 1$. \[тривиально]
- Если $n(x)<n(y)$, то $h(x)\le h(y)$. \[тривиально]
- Из этого утверждения исходное следует тривиальным образом
# Раскраски
## Двусвязный граф. Лемма (к теореме Брукса) (Билет 7)
**k-связный граф**
- Граф называется **двусвязным**, если он связен и не имеет точек сочленения
- Граф именуется **k-связным**, если он связен и при удалении **_менее_** $k$ вершин он остаётся связным
**Пояснение**
1. То есть [двусвязный граф](https://ru.wikipedia.org/wiki/%D0%94%D0%B2%D1%83%D1%81%D0%B2%D1%8F%D0%B7%D0%BD%D1%8B%D0%B9_%D0%B3%D1%80%D0%B0%D1%84) не теряет связности при удалении вершины

**Лемма** (к т.Брукса)
$$\begin{cases}\;1.\;G\text{ - двусвязен}\\\;2.\;\text{минимальная степень вершины в $G\ge3$}\\\;3.\;G\;\text{- неполный}\end{cases}\;\;\Rightarrow\;\;\exists a,b,c\in V(G):\;\begin{cases}\;1.\;(a,b),(b,c)\in E(G)\\\;2.\;(a,c)\notin E(G)\\\;3.\;G\setminus\{a,b\}\;\text{связен}\end{cases}$$
**Доказательство**
- Допустим, граф трёхсвязный. Тогда по его неполноте очевидно, что искомые вершины $a,b,c$ существуют\[1]
- Пусть граф не трёхсвязен. Тогда существует вершина $b$, удаление которой приводит к появлению точек сочленения. Такой блок имеет висячие блоки\[2]. По двусвязности исходного графа точка $b$ должна быть связана с точками $a$ и $c$ в двух разных висячих блоках.
- При удалении вершин $a$ и $c$ из их соответствующих блоков сами блоки остаются связными. Понятно, что граф $G\setminus\{a,b,c\}$ также остаётся связным.\[3] 
- Из того, что степень вершины $b$ больше трёх, следует, что точка $b$ не станет изолированной в графе $G\setminus\{a,c\}$. Значит, этот граф связный.
**Пояснение**
1. Неполнота гарантирует существование двух несмежных вершин. Так как блок трёхсвязный, то мы можем удалить две вершины, и там появятся точки сочленения. Значит, граф имеет структуру следующего вида: имеется набор "протоблоков" - некоторых подграфов, которые после удаления двух вершин станут блоками - которые соединены, помимо точек сочленения, ещё одной точкой. Таким образом и получается искомая структура - вершины принадлежат разным блокам, а третья их связывает. В свою очередь связность графа без этих двух вершин гарантируется трёхвсязностью
2. Было доказано ранее, что блок с точками сочленения имеет висячие блоки
3. Удалению подлежат внутренние точки протоблоков, которые не перейдут после удаления $b$ в точки сочленения. Почему? Допустим, что $a$ станет точкой сочленения после удаления $b$. Но тогда $a$ была точкой сочленения изначально, а значит, граф не был двусвязным
4. См. поясняющий рисунок:![[Pasted image 20240809111953.png]]
## Раскраска графа, хроматическое число графа. Теорема Брукса (Билет 17)
**Раскраска графа**
- **Правильной раскраской** графа $G$ является такое отображение $\varphi$ из $V(G)$ в множество красок $\{c_1, \cdots, c_n\}$, что для всех смежных вершин $u$ и $v$ - $\varphi(u)\ne\varphi(v)$.
- Граф называется **n-раскрашиваемым**, если существует его правильная раскраска в $n$ красок 

**Хроматическое число графа**
- **Хроматическим числом** графа $G$ называется минимальное возможное число $n$, в которое можно покрасить граф $G$. Обозначение: $\chi(G)$

**Теорема**
$$\text{$G$ двудольный} \;\;\Leftrightarrow\;\;\chi(G)=2$$
**Доказательство**
- Очевидно следует из определения [двудольного графа](https://ru.wikipedia.org/wiki/%D0%94%D0%B2%D1%83%D0%B4%D0%BE%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D0%B3%D1%80%D0%B0%D1%84)\[1]
- **Двудо́льный граф**— это граф, вершины которого можно разбить на две части так, что каждое ребро соединяет вершину из одной части с вершиной другой части. То есть, между вершинами одной и той же части рёбра отсутствуют.
**Лемма** (х)
$$\begin{cases}\;1.\;G\text{ - связный граф}\\\;2.\;\Delta(G)\le d\\\;3.\;\exists v\in V(G):\;\deg(v)<d\end{cases}\;\;\Rightarrow\;\;\chi(G)\le d$$
**Доказательство**
- Проведём индукцию по количеству вершин. База - граф с $v(G)\le d$ - очевидна.
- Пусть $u$ - вершина, $\deg(u)<d$. Рассмотрим $G\setminus\{u\}$. Все компоненты связности этого графа имели вершины, смежные с $u$, и каждая такая вершина теперь имеет степень меньше $d$ (по 2 пункту условия). По ИП на каждой КС можно задать правильную $d$-раскраску (а значит, и всему графу). Возвращаем $u$, покрасив в её в один из незанятых цветов и получим искомую раскраску
**Пояснение**
0. $\Delta(G)$ - максимальная степень вершины
1. Достаточно просто на каждую вершину дать свою краску
2. $\deg(u)\le d-1$, то есть смежные вершины закрашивают максимум $d-1$ из $d$ цветов

**Теорема** (Брукса)
$$\begin{cases}\;1.\;d\ge3\\\;2.\;G\;\text{связный, не полный на $d+1$ вершине}\\\;3.\;\Delta(G)\le d\end{cases}\;\;\Rightarrow\;\;\chi(G)\le d$$
**Доказательство**
- Пусть в данном графе степени вершин различны. В таком случае вывод напрямую следует из _Леммы (х)_
- Пусть все степени вершин равны и граф имеет точку сочленения $a$. В таком случае граф $G=G_1\sqcup G_2$, $G_1\cap G_2=\{a\}$ разбивается на два графа, в каждом из которых удовлетворяется _Лемма (х)_.\[1] Очевидно, что и весь граф можно покрасить в $d$ цветов.
- Пусть граф двусвязный. По лемме к теореме Брукса $\exists a,b,c\in V(G):\;\begin{cases}\;1.\;(a,b),(b,c)\in E(G)\\\;2.\;(a,c)\notin E(G)\\\;3.\;G\setminus\{a,b\}\;\text{связен}\end{cases}$. Рассмотрим остовное дерево $T$ графа $G'=G\setminus\{a,c\}$, корнем которого назначим вершину $b$. Распределим вершины по уровням (то есть по расстоянию до $b$).
- Начнём раскраску с вершин на самом высоком уровне (то есть с некоторых листьев дерева). На каждом уровне было покрашено максимум $d-1$ вершин - соседей данной вершины $x$, исключая непокрашенного предка, который будет закрашен на следующем шаге. Значит, можно выбрать $d$-ый цвет для $x$.
- Рассмотрим последний шаг раскраски. Для вершины $b$ уже покрашены все смежные вершины, которых $d-2$. Выберем один цвет для $b$, а ещё один - для $a,c$ (их мы красим в одинаковый цвет). Получили правильную раскраску $G$ в $d$ цветов
**Пояснение**
1. Каждый граф связен, условие 3 сохраняется, $\deg(a)$ в каждом этом блоке очевидно меньше $d$.
2. Например, поиском в ширину
## Плоские и планарные графы. Теорема Эйлера (Билет 18)
**Плоский граф**
- **Плоский граф** - это граф, который вложен в пространство $\mathbb{R}^2$.
- Рёбра такого графа пересекаются только в его вершинах. Запрещается пересечение рёбер не в вершинах графа
**Планарный граф**
- **Планарный граф** - это граф, который изоморфен некоторому плоскому графу
**Грань**
- Плоский граф разбивает плоскость, на которой нарисован, на некоторое количество граней - одну внешнюю и некоторое количество внутренних, то есть ограниченных рёбрами графа
- Обозначение множества граней - $F(G)$

_В рамках данного параграфа $v(G)$, $e(G)$, $f(G)$ я буду обозначать как $В$, $Р$ и $Г$ соответственно_

**Теорема** (формула Эйлера)
$$G\text{ планарный} \;\;\Rightarrow\;\;В-Р+Г=2$$
**Доказательство**
- Докажем индукцией по числу граней. Грань представляет из себя некоторый цикл в $G$, который ликвидируется при рассмотрении _остовного дерева_. Для дерева данное соотношение очевидно (база индукции). Докидываем рёбра, образуя новые грани. Получается, что:
  - $В=В$
  - $Р = Р + 1$
  - $Г = Г + 1$
  А значит соотношение не нарушилось

**Замечание** (следствие формулы Эйлера)
- В плоском графе без висячих вершин, кратных рёбер и петель: $Р \le 3В-6$
**Доказательство**
- У каждой грани не менее трёх рёбер. Очевидно, $3Г\le2Р$, т.е. $2Р - 3Г\ge 0$ (1)
- Получим: $В-Р+Г=2\;\Rightarrow\; 3В - 3Р + 3Г = 6$ (2); (2) + (1) $\Rightarrow\; 3В - Р \ge 6\;\Rightarrow\; Р\le3В-6$
**Пояснение**
- Иногда данное соотношение можно использовать для быстрого доказательства непланарности графа. Скажем, для полного графа на $5$ вершинах ($K_5$) получится, что $15 > 15-6$.

## Теорема о пяти красках (Билет 19)
**Лемма** (о перекрашивании вершин)
- Если дана некоторая раскраска графа, то в графе $G_{1,2}$, порождённом вершинами с цветами $1$ и $2$, в любой компоненте связности можно поменять цвет вершин на противоположный, не нарушив правильность раскраски графа $G$.

**Теорема о пяти красках**
- У планарного графа есть правильная покраска в 5 цветов

**Доказательство**
- Докажем индукцией по количеству вершин. Для $v(G)\le 5$ всё очевидно (база индукции)
- Пусть $v_0$ новая вершина. Если $\deg(v_0)<5$ или количество цветов, занятых смежными вершинами, меньше $5$, то переход очевиден
- Пусть $\deg(v_0)=5$ и заняты все 5 цветов. В таком случае рассмотрим вершины, смежные с $v_0:v_1,v_2,\cdots,v_5$. Рассмотрим $G_{1,3}$. Если $v_1,v_3$ находятся в одной КС графа $(G\setminus\{v_0\})_{1,3}$, то тогда $v_2,v_4$ - в разных КС графа $(G\setminus\{v_0\})_{2,4}$. В таком случае берём КС от вершины $v_2$ и меняем в ней цвета $2$ и $4$, что по лемме возможно.
**Пояснение**
- Картиночка. Напомню, что на дворе планарный граф, а значит вершина $v_2$ в ловушке и не может выбраться из данной КС
- $G_{1,3}$ - подграф графа $G$, порожденный  всеми вершинами $u$ такими, что $f(u) \in \{1, 3\}$ 
 ![[Pasted image 20240918082919.png|300]]



# Покрытия
## Вершинные и рёберные покрытия. Свойства чисел $\alpha(G), \alpha'(G), \beta(G), \beta'(G)$
**Независимость вершин графа**
- Множество вершин графа называется **независимым**, если любые его вершины несмежны
- Максимальный размер независимого множества над данным графом обозначается $\alpha(G)$. 

**Паросочетания**
- Множество рёбер называется **паросочетанием**, если никакие два ребра не имеют общей вершины
- Размер максимального паросочетания - $\alpha'(G)$.

**Вершинное покрытие**
- Множество вершин **покрывает** граф, если любое ребро графа содержит хотя бы одну вершину из данного множества
- Размер минимального из возможных вершинных покрытий - $\beta(G)$.

**Рёберное покрытие**
- Множество рёбер покрывает граф, если каждая вершина инцидентна хотя бы одному ребру из этого множества
- Размер минимального рёберного покрытия - $\beta'(G)$.

**Свойства чисел** $\alpha(G), \alpha'(G), \beta(G), \beta'(G)$
- $\beta(G)\ge\alpha'(G)$ \[1]
- $\beta'(G)\ge\alpha(G)$ \[2]
- $\alpha(G)+\beta(G)=v(G)$ \[3]
- Если нет изолированных вершин\[5]: $\alpha'(G)+\beta'(G)=v(G)$\[4]
**Пояснение**
1. Рассмотрим число $\alpha'(G)$. Это число представляет из себя мощность множества независимых рёбер - рёбер без общих концов. Для составления минимального множества для $\beta(G)$ нам потребуется взять по крайней мере по одной вершине от каждого такого ребра - иначе будет непокрытое ребро
2. Аналогично - имеем независимые вершины в множестве мощностью $\alpha(G)$. Тогда для создания рёберного покрытия нам нужно взять как минимум по одному ребру, инцидентному с каждой из этих вершин - иначе будут покрыты не все вершины.
3. Потому что $V(G)\setminus V_0=V_b$, где $V_0$ - максимальное множество независимых вершин, $V_b$ - минимальное вершинное покрытие.
4. Докажем два неравенства:
   1) Возьмём максимальное паросочетание мощности $\alpha'(G)$. Это паросочетение "съело" $2\alpha'(G)$ вершин из графа, остались ещё $v(G)-2\alpha'(G)$. Значит, существует рёберное покрытие из  $v(G)-1\cdot\alpha'(G)$ рёбер\[6], то есть $\beta'(G)\le v(G)-\alpha'(G)$ (т.к. $\beta'(G)$ - минимальная мощность), значит, $\alpha'(G)+\beta'(G)\le v(G)$.
   2) Выберем минимальное рёберное покрытие. Оно по сути своей является подграфом $G$ на тех же вершинах. В этом подграфе, очевидно, нет циклов (иначе на одну вершину по два ребра, что противоречит минимальности). То есть это лес, причём каждая КС этого леса выглядит как звезда (опять же по минимальности нет путей длины > 2). Звезда с k+1 вершиной обычно обозначается $S_{k}$
   ![[Pasted image 20240918085726.png|200]]
   Отсюда получается неравенство $\alpha'(G)\ge v(G)-\beta'(G)=\text{[число КС]}=\text{[одно ребро из каждой КС]}$. А значит $\alpha'(G)+\beta'(G)\ge v(G)$
5. Потому что при наличии изолированных вершин никакого рёберного покрытия в принципе не существует - изолированную вершину никаким ребром покрыть нельзя
6. Уже взятые в $\alpha'(G)$(1) и по одному на каждую из $v(G)-2\alpha'(G)$(2) вершин (т.е. надо просто сложить 1 и 2), смежных между которыми нет, потому что смежность там означала бы наличие независимого ребра.

____
#TODO 
При рассказе про паросочетания:
Лемма 4.1. Для любого графа G выполняется неравенство
χ(G) · α(G) ≥ v(G).
Доказательство. Утверждение очевидно следует из соображения о том,
что все вершины одного цвета в правильной раскраске попарно несмежны, то есть образуют независимое множество.
____
## Теорема Бержа, теорема Кёнига, теорема Холла
**Чередующийся путь**
- Пусть $E_0$ - паросочетание. Тогда **чередующийся путь** в графе $G$ по отношению к $E_0$ - это путь, в котором два соседних ребра отличаются относительно принадлежности к паросочетанию. То есть рёбра идут как "НП - П - НП - П - НП - ... - П - НП"

**Утверждение**
Если в графе есть максимальный по включению _простой_ чередующийся путь, концы которого не принадлежат паросочетанию, то паросочетание не максимальное
**Доказательство**
- Просто выбросим из $E_0$ "П" рёбра и добавим "НП" рёбра. Обозначим полученное паросочетание как $E'_0$. В нем на одно ребро больше и при том оно остается паросочетанием, так как из концов данного пути не могут идти ребра из $E_0$ (это следует из условия: путь был максимальным по включению) ч.т.д.

**Теорема Бержа** (о максимальном паросочетании в произвольном графе) (Билет 20)
$$E_0\text{ не максимальное}\Rightarrow\displaylines{\text{ Существует максимальный по включению простой}\\\text{чередующийся путь с концами не из } E_0}$$
**Доказательство**
- Пусть $E_1$ - паросочетание с большим числом рёбер. Рассмотрим $E_1\;\triangle\; E_0  = (E_0 \setminus E_1) \cup(E_1 \setminus E_0)$. Это подграф, степень каждой вершины которого не превосходит 2, откуда следует, что каждая его КС - это цепи и циклы. 
- Вполне очевидно, что $|E_1\setminus(E_1\cap E_0)|>|E_0\setminus(E_1\cap E_0)|$. Также очевидно, при построении пути рёбра чередуются. Поэтому среди КС $E_1\;\triangle\; E_0$ существует хотя бы один незамкнутый путь с принадлежностями вида "1 - 0 - 1 - 0 - ... - 0 - 1" - потому что иначе идёт нарушение данного выше неравенства.
- Этот путь максимальный по включению - потому что мы рассмотрели целиком некоторую КС графа $E_1\;\triangle\; E_0$ - значит, больше никаких рёбер ни от куда не выходит. Также никаких рёбер не существует и в выброшенном $E_1\cap E_0$ - потому что все рёбра их этого пересечения это рёбра $E_1$, а не некотором ребре из $E_1$ мы закончили построения пути. Таким образом не существует "следующего" ребра из $E_0$, а значит путь максимален по включению.

**Теорема Кёнига** (Билет 22)
$$\text{Для двудольного графа:}\;\;\;\;\beta(G)\overset{[1]}=\alpha'(G)$$
**Доказательство**
- Разделим всё множество вершин на две группы по долям двудольного графа, а после - на три класса: $U_i$ - вершины, которым не инцидентны рёбра из максимального паросочетания $A'$, $Y_i$ - вершины, до которых можно дойти из $U_i$ по чередующимся путям и $Z_i$ - до которых нельзя![[Pasted image 20240918140925.png|250]]
- Ребро между $U_1$ и $U_2$ невозможно по причине того, что это противоречит максимальности $A'$ (их можно было бы записать туда)
- Рёбра из $A'$ могут соединять только $Y_1,Y_2$ и $Z_1,Z_2$, потому что иначе можно было бы дойти чередующимся путём $U_1\rightarrow Y_2\rightarrow Z_1$ или $U_2\rightarrow Y_1\rightarrow Z_2$. (Т.е. есть путь $U_1\rightarrow Z_1$ - противоречие). Отсюда следует, что $|Y_1|=|Y_2|$, $|Z_1|=|Z_2|$.
- Рёбра из $A'$ не могут соединять $U_1,Z_2$, потому что тогда существовал бы чередующийся путь $Y_1\rightarrow Y_2\rightarrow U_1\rightarrow Z_2$, то есть между $U_1, Z_2$.
- Рёбер между $U_2,Y_1$ не существует по т. Бержа (потому что иначе будет макс по включению чередующийся путь $U_1\rightarrow Y_2\rightarrow Y_1\rightarrow U_2$)
- $|A'|=|Z_1\cup Y_2|$, потому что известно, что на каждое ребро из $A'$ нужно хотя бы одну вершину, а больше взять просто не получится. Получается, что $Z_1\cup Y_2$ - покрывающее множество минимального размера, а сам размер равен $|A'|=\alpha'(G)$
**Пояснение**
1. Напомню, что совсем недавно для всех графов было доказано неравенство $\beta(G)\ge\alpha'(G)$



**Теорема Холла** (Билет 23)
$$\displaylines{\text{В двудольном графе есть}\\\text{паросочетание, покрывающее}\\\text{все вершины доли $V_1$ $_{[1]}$}}\;\Leftrightarrow\;\displaylines{\forall \;U\subset V_1:\;|U|\le|N_G(U)|\;_{[2]}}$$
![[Pasted image 20240918142317.png|600]]
**Доказательство**
- =\> очевидно
- <= докажем индукцией по количеству вершин в графе. Для графа, где $|V_1|=1$, утверждение очевидно (база индукции). Далее рассмотрим два случая
  1) $\exists A\subsetneq V_1:\;|A|=|N_G(A)|$. В таком случае обозначим:![[Pasted image 20240817175835.png]] Условие теоремы очевидно выполняется для $G(A\cup B)$. Проверим выполнимость условия для $G(A'\cup B')$: $$\displaylines{?:\;\exists\;X\subset A':\;|X|>|N_{G(A'\cup B')}(X)|. \\!:\;|N_G(X\cup A)|=|N_G(A)|+|N_G(X)|<|A|+|X|=|A\cup X|}$$что противоречит условию теоремы. Значит, для $G(A'\cup B')$ условие теоремы выполнено и оба графа $G(A\cup B)$ и $G(A'\cup B')$, по ИП, имеют искомые вершинные покрытия, а значит и весь $G$ имеет оное
  2) $\forall A\subsetneq V_1:\;|A|<|N_G(A)|$. Из этого, после выбрасывания одной вершины из $V_1$ и другой, смежной с первой - из $V_2$, автоматически следует ИП\[3]. По возвращении вершин обратно вместе с их общим ребром, добавленном в паросочетание, обнаруживаем выполнение условия. 
**Замечание**
- Данная теорема следует из теоремы Кёнига. Действительно, допустим, размер минимального вершинного покрытия меньше размера $V_1$. Зададим это МВП. Окажется, что вершины из $V_1$, не входящие в покрытие, обязаны быть связаны лишь с теми вершинами $V_2$, которые вошли в покрытие (иначе получится не покрытое ребро). Но таких вершин в $V_2$ явно меньше. То есть мы нашли такое $U\subset V_1:\;|V_1|>|N_G(U)|$. Это противоречие условию приводит нас к тому, что размер МВП больше или равен размеру $V_1$. Больше он, очевидно, быть не может - следовательно, он равен ему, по т. Кёнига это означает, что размер максимального рёберного покрытия равен размеру $V_1$, а значит, на каждую вершину придётся по ребру из этого паросочетения
**Пояснение**
1. $V_1$ - первая доля двудольного графа
2. $N_G(U)$ - окрестность множества вершин $U$ - множество всех вершин, которые смежны с вершинами из этого множества, не включая сами вершины множества $U$.
3. Выбросим эти вершины. В таком случае $|A|\le |N_G(A)|-1\le |N_{G}(A\setminus\{b\})|=|N_{G'}(A)|$, удовлетворяющее условию теоремы - значит, такой подграф подходит для ИП. 
## Применение т. Холла для раскраски графов
**Совершенное паросочетание**
- Назовём паросочетание **совершенным**, если оно одновременно с этим является и рёберным покрытием

**Утверждение**
- В регулярном двудольном графе существует совершенное паросочетание
- **Регулярный граф**— граф, степени всех вершин которого равны, то есть каждая вершина имеет одинаковое количество соседей.

**Доказательство**
- Пусть степени регулярного двудольного графа равны $k$. Для любого $A\subset V_1$  $|A|\le|N_G(A)|$\[1] - значит, есть паросочетание, покрывающее $V_1$, которое, в силу регулярности графа, равно $V_2$

**Следствие**
- _Регулярный двудольный граф степени $k$ - объединение $k$ своих совершенных паросочетаний_. Это очевидно, поскольку удаление построенного в доказательстве выше совершенного паросочетания приводит к новому регулярному $k-1$ графу
- _В регулярном двудольном графе степени $k$ возможна правильная рёберная $k$-раскраска_. Для её построения достаточно покрасить каждое выделенное паросочетание в свой цвет
**Пояснение**
1. Если это не так, то на меньше, чем $|A|$ вершин должно прийтись $k|A|$ рёбер, то есть на каждую вершину больше, чем $k$, что невозможно по регулярности графа

## Теорема Дилуороса (Билет 25)
**Частично упорядоченное множество**
- **Частично упорядоченное множество** - это множество с заданным отношением порядка. В нём могут существовать как элементы, состоящие в отношении, так и элементы, не состоящие в нём.\[1]
- Множество элементов, попарно не состоящих друг с другом в отношении, назовём **антицепью**
**Пояснение**
1. Пример такого множества: $2^A$ от $A=\{x,y,z\}$ с отношением включения. Будем иметь как $\{\varnothing\}\subset\{x\}\subset\{x,y\}\subset\{x,y,z\}$, так и не состоящие в таком отношении $\{x\}$ и $\{y\}$

**Теорема** (Дилуороса)
- Частично упорядоченное множество $A$ может быть разбито на $m$ непересекающихся цепей, где $m=n$ - длина максимальной антицепи.
**Доказательство**
- Очевидно, что цепей не может быть меньше, чем длина антицепи - то есть $m\ge n$
- Рассмотрим двудольный граф, где каждая доля $V_i=A$, а ребро $(a^{(V_1)}_i,a^{(V_2)}_j)$ существует, если $a_i<a_j$ относительно нашего отношения порядка.
- Очевидно, что $\alpha'(G)=|A|-m$, где $m$ - количество непересекающихся цепей (просто потому что самое очевидное и одновременно с этим максимальное паросочетание - это паросочетание, идущее по пути прямого увеличения\[1]). 
- $\alpha(G)\overset{[2]}{=}v(G)-\beta(G)=2|A|-\beta(G)\overset{[3]}{=}2|A|-\alpha'(G)=2|A|-|A|+m=|A|+m$. Данное число - это число вершин из графа на $2|A|$ вершин, которые попали в независимое множество. В этом множестве будут как вершины, попавшие "единожды", так и вершины, попавшие "дважды"\[4]. Однако очевидно, что вершин, попавших единожды, максимум $|A|$. Значит вершин, попавших дважды, не менее $m$. То есть $m\le n$.
**Пояснение**
1. В приведённом выше примере цепи по пути прямого увеличению могут быть: $\{\varnothing\},\{x\},\{x,y\},\{x,y,z\}$; $\{y\}, \{y, z\}$; $\{z\}, \{x,z\}$.
2. Соотношение между $\alpha, \beta, \alpha', \beta'$
3. т. Кёнига
4. Здесь имеется в виду то, что исходные $|A|$ вершин при создании графа были дублированы и находятся как бы "друг напротив друга" на рисунке данного графа. _Единожды_ относительно рисунка графа - значит, из двух находящихся друг на против друга вершин выбрана одна. Попадание же в пару подразумевает, что между этой парой и остальными вершинами графа нет рёбер ни в направлении из $V_1$ в $V_2$, ни наоборот, а значит, они никак не связаны отношением порядка в $A$. 
# Хроматический многочлен, хроматический индекс (Билет 26)

## Хроматический многочлен
**Хроматическое число графа** (напоминание)
- Хроматическим числом графа $G$ называется минимальное возможное число $n$, в которое можно покрасить граф $G$. Обозначение: $\chi(G)$

**Хроматический многочлен**
- Количество правильных $k$-раскрасок графа - $\chi_G(k)$
- **Хроматическим многочленом** $\chi_G(t)$ называется такой многочлен, что при подстановке $k$ получится $\chi_G(k)$

**Существование хроматического многочлена**
- Если $G$ - лес из $n$ пней, то $\chi_G(t)=t^n$
- Далее пойдём по индукции следующим путём: рассмотрим для $e\in E(G)$ графы $G\setminus\{e\}$ с выброшенным ребром и $G/\{e\}$ со стянутым ребром\[3]. Тогда $\chi_G(t)\overset{[2]}{=}\chi_{G\setminus\{e\}}(t)-\chi_{G/\{e\}}(t)$
- Утверждение далее тривиально доказывается по индукции
**Пояснение**
1. Напомню, что это - полный граф на $n$ вершинах
2. Рассмотрим $G\setminus\{e\}$ с некоторой его раскраской. Если вершины данной раскраски покрашены в разные цвета, то эту раскраску относим в $\chi_G$. Если в одинаковый - то в $\chi_{G/\{e\}}$. 
3. Читается как $G$ фактор $e$.

**Утверждение**
- Хроматический многочлен графа равен произведению хроматических многочленов его КС
**Доказательство**
- Очевидно из того, что $G=\bigsqcup G_{[\text{компонента связности }i]}$ и из их независимости

**Утверждение**
- Пусть $G$ - связный, но не $k$-связный граф. Тогда $$\chi_G(t)=(\frac{1}{t})^{n-1}\prod_i^n\chi_{[\text{Блок i графа }G]}(t)$$
**Доказательство**
- Рассмотрим висячий блок $G_1$ в $G=G'\cup G_1$. В таком случае сначала зададим расцветку $G'$ за $\chi_{G'}(t)$. Из всех расцветок блока $G_1$, которых $\chi_{G_1}(t)$, нас интересуют только те, в которых точка сочленения блока с остальным графом покрашена так же, как и в $G'$ - таких способов у нас $^{\chi_{G_1}(t)}/_t$.
- Далее доказательство идёт тривиально по индукции
**Следствие**
- Для дерева на $n>1$ вершинах $\chi_G(t)=t(t-1)^{n-1}$. 
- Объединяя с предыдущим утверждением, эту формулу можно записать в виде: $$\chi_G(t)=(\frac{1}{t})^{n-c(G)}\prod_i^n\chi_{[\text{Блок i графа }G]}(t)$$
**Теорема** (Билет 27)
- Кратность единицы как корня $\chi_G(t)$ равно числу блоков
**Доказательство**
- Единица является корнем $\chi_G(t)$, потому что раскраска графа на более чем одной вершине с хотя бы одним ребром на 1 цвет невозможна. 
- Смотрим на общую формулу, приведённую выше. Понятно, что деление на $t$ не меняет кратность единицы как корня, если блок содержит более одной точки. В таком случае достаточно проверить, что на каждый блок кратность единицы как корня равна $1$
- Пусть $B$ - блок с $n\ge 3$ вершинами. В $B$ существует такое ребро, что $B/\{e\}$ - тоже блок. Для этого достаточно стянуть любое ребро, инцидентное такой $v$, что $G\setminus\{v\}$ всё ещё блок.
- Пусть $G\setminus\{v\}$ не блок. Тогда изначально $G$ имел следующую структуру:![[Pasted image 20240820181451.png]]В такой структуре достаточно выбрать в качестве ребра для стягивания любое ребро $(v,u_i)$.
- Для того, чтобы доказать, что кратность $1$ как корня $\chi_G(t)$ равна единице, достаточно доказать, что кратность $1$ как корня его производной ($\chi'_G(t)$) равна нулю
- Далее делаем индукцию, пользуясь соотношением $\chi'_G(1)=(\chi_{G\setminus\{e\}}(1)-\chi_{G/\{e\}}(1))'=\chi'_{G\setminus\{e\}}(1)-\chi'_{G/\{e\}}(1)$. Для блока на 2х вершинах это условие очевидно потому как $\chi_\cdot(t)=t(t-1)$, то есть $\chi_\cdot'(t)$ имеет тот же знак, что $(-1)^2$. Далее считаем, что для блока с меньшим числом рёбер данное утверждение доказано. Получатся, что: $\chi'_{G/\{e\}}(1)$ имеет тот же знак, что $(-1)^{n-1}$ при $n-1$ вершине; а граф $G\setminus\{e\}$ или является блоком - тогда знак $\chi'_{G\setminus\{e\}}(1)$ тот же, что и у $(-1)^n$, или состоит из блоков, а значит $\chi'_{G\setminus\{e\}}(1)=0$, ведь на каждый блок приходится по одной скобке $(t-1)$.
- Из всего вышесказанного и получается, что $\chi'_G(1)\ne 0$.
## Рёберные раскраски, хроматический индекс графа (Билет 28)
**Рёберная раскраска**
- **Правильной рёберной $k$-раскраской** или просто рёберной $k$-раскраской неографа называется такая раскраска рёбер, что в каждую вершину приходят рёбра разных цветов

**Покрывающая раскраска**
- **Покрывающая $k$-раскраска** - это такая раскраска рёбер, что в каждую вершину входят рёбра каждого из $k$ цветов

**Оптимальная раскраска**
- **$k$-оптимальное раскраской** называется такая раскраска, что при $k$ цветов достигается максимум суммы вида: $$\sum_{v\in V(G)}\rho(v),\;\;\;\;\;\;\rho(v)-\text{ Количество цветов, входящих в эту вершину}$$(то есть в остальных $k$-раскрасках эта сумма такая же или меньше)
- Обозначим эту сумму как $\rho(G)$. Очевидно, что $$\displaylines{\rho(G)\le \sum_{V(G} \deg(v)=2e(G)\\\rho(G)\le k\cdot v(G)}$$
**Хроматический индекс**
- Минимальное $k$, что $k$-раскраска правильная, называется **хроматическим индексом** графа
- Обозначение - $x(G)$. Обычно используется обозначение $\chi'(G)$, но дабы не раздражать самого себя коллизией с производной хроматического многочлена да и просто ради простоты письма будет использоваться именно $x(G)$.
- Очевидное утверждение: $x(G)\ge\Delta(G)$

**Лемма**
$$x(G)\ge\frac{e(G)}{\alpha'(G)}$$
**Доказательство**
- Очевидно. Все рёбра одного цвета составляют паросочетание не большее по размеру, чем максимальное. Получается, что минимальное $k$ случится ровно при случае $^{e(G)}/_{\alpha'(G)}$.
**Следствие**
- $n=2m:\;\;x(K_n)=n-1;\;\;\;\;\;\;\;\; n=2m-1:\;\; x(K_n)= n$
## Лемма об оптимальной раскраске в два цвета, теорема Кёнига о хроматическом индексе двудольного графа, теорема Гупта (Билет 29)
**Лемма** (об оптимальной раскраске в два цвета)
- Рёбра _связного_ графа $G$ можно покрасить в два цвета так, что в любой вершине $\deg(v)\ge2$ будут встречаться оба цвета кроме случая, когда имеется цикл нечётной длины
**Доказательство**
- Рассмотрим вершины нечётной степени (их чётное количество по лемме о рукопожатиях) и соединим их с фантомной вершиной $w_0$. Теперь все вершины имеют чётную степень, а значит в графе имеется Эйлеров цикл.
- Начнём обход цикла, начиная с $w_0$ или с любой вершины степени $\deg(v)\overset{[1]}{\ge}4$, если такую добавлять не потребовалось. Начинаем красить, чередуя рёбра. Получается, что через каждую вершину степени $\ge 2$ мы войдём+выйдем или дважды и при этом не через $w_0$ или четырежды, максимум один раз через $w_0$. И каждый раз входить и выходить мы будем по разным краскам
- В начальной вершине может случиться, что начнём и закончим обход мы по одинаковым рёбрам. Но для этого мы и взяли степень больше $4$
**Пояснение**
1. Если вдруг таких не оказалось, то мы имеем граф с вершинами степени $2$, то есть цикл, который или очевидно красится, или имеет нечётную длину

**Теорема** (Кёнига, о хроматическом индексе двудольного графа)
$$G\text{ - двудольный граф}\;\;\Rightarrow\;\;x(G)=\Delta(G)$$
**Доказательство**
- Доказываем по индукции по количеству рёбер (число $\Delta(G)$ исходного графа фиксируем), что у любого подграфа $G$ есть правильная раскраска в $\Delta(G)$ цветов. Для этого рассматриваем случайный $G'\subset G$, выбрасываем из него случайное ребро $e$ - по ИП получаем некоторый двудольный граф с $x(G'\setminus\{e\})$ как максимум $\Delta(G)$. Значит, правильная раскраска существует. 
- Добавляем обратно ребро $e$. Если среди двух вершин есть незанятый цвет, то красим ребро в него, а если такого нет, то совершаем процедуру перекрашивания двух цветов в графе $G'(E_{1,2})_{[1]}\cup \{e\}$ так, чтобы там была правильная $2$-раскраска (что возможно по лемме об оптимальной раскраске)\[2]\[3]
**Пояснение**
1. Это граф, порождённый из $G'$ только рёбрами с цветами $1$ и $2$
2. Все вершины $G'(E_{1,2})_{[1]}\cup \{e\}$, очевидно, степени не более двух
3. В двудольном графе не бывает циклов нечётной длины

**Теорема Гупта**
- В двудольном графе существует покрывающая раскраска в $\delta(G)$ цветов
**Доказательство**
- 
